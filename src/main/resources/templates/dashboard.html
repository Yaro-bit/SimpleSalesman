<!DOCTYPE html>
<html lang="de" layout:decorate="~{layout}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org">
 <head>
  <title th:text="'Dashboard - SimpleSalesman'">
   Dashboard
  </title>
 </head>
 <body>
  <div layout:fragment="content">
   <!-- Enhanced Page Header -->
   <div class="page-header">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center">
     <div>
      <h1 class="h2 mb-1">
       <i class="fas fa-chart-line text-primary me-2">
       </i>
       Dashboard
      </h1>
      <p class="text-muted mb-0">
       Übersicht über Ihre Verkaufsaktivitäten
      </p>
     </div>
     <div class="btn-toolbar">
      <div class="btn-group me-2">
       <a class="btn btn-success hover-lift" th:href="@{/web/addresses/new}">
        <i class="fas fa-plus me-1">
        </i>
        Neue Adresse
       </a>
       <a class="btn btn-info hover-lift" th:href="@{/web/import}">
        <i class="fas fa-file-excel me-1">
        </i>
        Excel Import
       </a>
      </div>
     </div>
    </div>
   </div>
   <!-- Enhanced Weather Widget -->
   <div class="row mb-4" th:if="${weatherInfo}">
    <div class="col-md-8 col-lg-6">
     <div class="card border-0 shadow-custom hover-lift">
      <div class="card-body" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
       <div class="d-flex align-items-center">
        <div class="weather-icon me-3">
         <i class="fas fa-cloud-sun fa-3x text-primary">
         </i>
        </div>
        <div class="flex-grow-1">
         <h5 class="card-title text-primary mb-1">
          <i class="fas fa-map-marker-alt me-1">
          </i>
          Wetter für
          <span th:text="${weatherRegion}">
           Region
          </span>
         </h5>
         <p class="card-text fs-4 mb-1" th:text="${weatherInfo}">
          Wetterdaten
         </p>
         <small class="text-muted">
          <i class="fas fa-clock me-1">
          </i>
          Aktualisiert: Jetzt
         </small>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
   <!-- Enhanced Statistics Cards -->
   <div class="row mb-4">
    <div class="col-xl-3 col-md-6 mb-4">
     <div class="card border-0 shadow-custom hover-lift h-100">
      <div class="card-body text-center">
       <div class="stat-icon mb-3">
        <i class="fas fa-map-marker-alt fa-3x text-primary">
        </i>
       </div>
       <h6 class="text-uppercase text-muted small mb-2">
        Gesamt Adressen
       </h6>
       <h2 class="text-primary font-weight-bold" th:text="${totalAddresses}">
        0
       </h2>
       <div class="progress mt-3" style="height: 4px;">
        <div class="progress-bar bg-primary" style="width: 75%">
        </div>
       </div>
      </div>
     </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
     <div class="card border-0 shadow-custom hover-lift h-100">
      <div class="card-body text-center">
       <div class="stat-icon mb-3">
        <i class="fas fa-project-diagram fa-3x text-success">
        </i>
       </div>
       <h6 class="text-uppercase text-muted small mb-2">
        Gesamt Projekte
       </h6>
       <h2 class="text-success font-weight-bold" th:text="${totalProjects}">
        0
       </h2>
       <div class="progress mt-3" style="height: 4px;">
        <div class="progress-bar bg-success" style="width: 60%">
        </div>
       </div>
      </div>
     </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
     <div class="card border-0 shadow-custom hover-lift h-100">
      <div class="card-body text-center">
       <div class="stat-icon mb-3">
        <i class="fas fa-tasks fa-3x text-warning">
        </i>
       </div>
       <h6 class="text-uppercase text-muted small mb-2">
        Aktive Projekte
       </h6>
       <h2 class="text-warning font-weight-bold" th:text="${activeProjects?.size() ?: 0}">
        0
       </h2>
       <div class="progress mt-3" style="height: 4px;">
        <div class="progress-bar bg-warning" style="width: 85%">
        </div>
       </div>
      </div>
     </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
     <div class="card border-0 shadow-custom hover-lift h-100">
      <div class="card-body text-center">
       <div class="stat-icon mb-3">
        <i class="fas fa-chart-pie fa-3x text-info">
        </i>
       </div>
       <h6 class="text-uppercase text-muted small mb-2">
        Status-Verteilung
       </h6>
       <div class="status-distribution" th:if="${projectStatusCounts}">
        <div class="d-flex justify-content-between align-items-center mb-1" th:each="statusEntry : ${projectStatusCounts}">
         <small class="text-muted" th:text="${statusEntry.key}">
          Status
         </small>
         <span class="badge bg-info rounded-pill" th:text="${statusEntry.value}">
          0
         </span>
        </div>
       </div>
       <div class="progress mt-3" style="height: 4px;">
        <div class="progress-bar bg-info" style="width: 90%">
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
   <!-- Enhanced Content Row -->
   <div class="row">
    <!-- Enhanced Recent Addresses -->
    <div class="col-lg-6 mb-4">
     <div class="card border-0 shadow-custom hover-lift h-100">
      <div class="card-header bg-transparent border-bottom-0 d-flex justify-content-between align-items-center">
       <h5 class="mb-0">
        <i class="fas fa-map-marker-alt text-primary me-2">
        </i>
        Neueste Adressen
       </h5>
       <a class="btn btn-sm btn-outline-primary hover-lift" th:href="@{/web/addresses}">
        <i class="fas fa-arrow-right me-1">
        </i>
        Alle anzeigen
       </a>
      </div>
      <div class="card-body">
       <div class="text-muted text-center py-4" th:if="${recentAddresses == null or #lists.isEmpty(recentAddresses)}">
        <i class="fas fa-inbox fa-3x text-muted mb-3">
        </i>
        <p class="mb-0">
         Keine Adressen vorhanden
        </p>
        <small>
         Erstellen Sie Ihre erste Adresse
        </small>
       </div>
       <div th:unless="${recentAddresses == null or #lists.isEmpty(recentAddresses)}">
        <div class="address-item border-bottom py-3 hover-lift" th:classappend="${iterStat.last ? 'border-0' : ''}" th:each="address, iterStat : ${recentAddresses}">
         <div class="d-flex justify-content-between align-items-center">
          <div class="flex-grow-1">
           <div class="d-flex align-items-center mb-2">
            <div class="address-avatar me-3">
             <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
              <i class="fas fa-home">
              </i>
             </div>
            </div>
            <div>
             <h6 class="mb-1" th:text="${address.addressText}">
              Adresse
             </h6>
             <small class="text-muted">
              <i class="fas fa-map-pin me-1">
              </i>
              <span th:text="${address.regionName ?: 'Keine Region'}">
               Region
              </span>
             </small>
            </div>
           </div>
          </div>
          <div class="action-buttons">
           <a class="btn btn-sm btn-outline-primary hover-lift" th:href="@{/web/addresses/{id}(id=${address.id})}" title="Details anzeigen">
            <i class="fas fa-eye">
            </i>
           </a>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <!-- Enhanced Active Projects -->
    <div class="col-lg-6 mb-4">
     <div class="card border-0 shadow-custom hover-lift h-100">
      <div class="card-header bg-transparent border-bottom-0 d-flex justify-content-between align-items-center">
       <h5 class="mb-0">
        <i class="fas fa-project-diagram text-success me-2">
        </i>
        Aktive Projekte
       </h5>
       <a class="btn btn-sm btn-outline-success hover-lift" th:href="@{/web/projects}">
        <i class="fas fa-arrow-right me-1">
        </i>
        Alle anzeigen
       </a>
      </div>
      <div class="card-body">
       <div class="text-muted text-center py-4" th:if="${activeProjects == null or #lists.isEmpty(activeProjects)}">
        <i class="fas fa-clipboard-list fa-3x text-muted mb-3">
        </i>
        <p class="mb-0">
         Keine aktiven Projekte
        </p>
        <small>
         Importieren Sie Projekte über Excel
        </small>
       </div>
       <div th:unless="${activeProjects == null or #lists.isEmpty(activeProjects)}">
        <div class="project-item border-bottom py-3 hover-lift" th:classappend="${iterStat.last ? 'border-0' : ''}" th:each="project, iterStat : ${activeProjects}">
         <div class="d-flex justify-content-between align-items-center">
          <div class="flex-grow-1">
           <div class="d-flex align-items-center mb-2">
            <div class="project-avatar me-3">
             <div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
              <i class="fas fa-building">
              </i>
             </div>
            </div>
            <div>
             <h6 class="mb-1">
              Projekt #
              <span th:text="${project.id}">
               ID
              </span>
             </h6>
             <div class="d-flex align-items-center">
              <span class="badge status-badge me-2" th:classappend="${project.status == 'OPEN' ? 'bg-primary' : 
                                                                           project.status == 'IN_PROGRESS' ? 'bg-warning text-dark' : 
                                                                           project.status == 'COMPLETED' ? 'bg-success' : 'bg-secondary'}" th:text="${project.status}">
               Status
              </span>
              <small class="text-muted" th:text="${project.operator}">
               Operator
              </small>
             </div>
            </div>
           </div>
          </div>
          <div class="action-buttons">
           <a class="btn btn-sm btn-outline-success hover-lift" th:href="@{/web/projects/{id}(id=${project.id})}" title="Details anzeigen">
            <i class="fas fa-eye">
            </i>
           </a>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
   <!-- Enhanced Quick Actions -->
   <div class="row mt-4">
    <div class="col-12">
     <div class="card border-0 shadow-custom">
      <div class="card-header bg-transparent border-bottom-0">
       <h5 class="mb-0">
        <i class="fas fa-bolt text-warning me-2">
        </i>
        Schnellaktionen
       </h5>
       <p class="text-muted small mb-0">
        Häufig verwendete Funktionen
       </p>
      </div>
      <div class="card-body">
       <div class="row g-3">
        <div class="col-md-3">
         <a class="btn btn-outline-success w-100 hover-lift d-flex flex-column align-items-center py-3" th:href="@{/web/addresses/new}">
          <i class="fas fa-plus fa-2x mb-2">
          </i>
          <span>
           Neue Adresse
          </span>
          <small class="text-muted">
           Adresse hinzufügen
          </small>
         </a>
        </div>
        <div class="col-md-3">
         <a class="btn btn-outline-info w-100 hover-lift d-flex flex-column align-items-center py-3" href="/swagger-ui.html" target="_blank">
          <i class="fas fa-book fa-2x mb-2">
          </i>
          <span>
           API Dokumentation
          </span>
          <small class="text-muted">
           Entwickler-Infos
          </small>
         </a>
        </div>
        <div class="col-md-3">
         <a class="btn btn-outline-warning w-100 hover-lift d-flex flex-column align-items-center py-3" th:href="@{/web/import}">
          <i class="fas fa-file-excel fa-2x mb-2">
          </i>
          <span>
           Excel Import
          </span>
          <small class="text-muted">
           Daten importieren
          </small>
         </a>
        </div>
        <div class="col-md-3">
         <button class="btn btn-outline-secondary w-100 hover-lift d-flex flex-column align-items-center py-3" onclick="refreshDashboard()" type="button">
          <i class="fas fa-sync-alt fa-2x mb-2">
          </i>
          <span>
           Aktualisieren
          </span>
          <small class="text-muted">
           Daten neu laden
          </small>
         </button>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
   <!-- Performance Metrics (Optional) -->
   <div class="row mt-4">
    <div class="col-12">
     <div class="card border-0 shadow-custom">
      <div class="card-header bg-transparent border-bottom-0">
       <h6 class="mb-0 text-muted">
        <i class="fas fa-chart-bar me-1">
        </i>
        Performance-Übersicht
       </h6>
      </div>
      <div class="card-body py-2">
       <div class="row text-center">
        <div class="col-3">
         <small class="text-muted d-block">
          Adressen heute
         </small>
         <strong class="text-primary">
          +3
         </strong>
        </div>
        <div class="col-3">
         <small class="text-muted d-block">
          Letzte Woche
         </small>
         <strong class="text-success">
          +12
         </strong>
        </div>
        <div class="col-3">
         <small class="text-muted d-block">
          Erfolgsrate
         </small>
         <strong class="text-info">
          85%
         </strong>
        </div>
        <div class="col-3">
         <small class="text-muted d-block">
          Aktiv seit
         </small>
         <strong class="text-warning">
          14 Tagen
         </strong>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- Enhanced Dashboard Scripts -->
  <div layout:fragment="scripts">
   <script>
    // Dark Mode Umschalten
    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }
    window.addEventListener('DOMContentLoaded', () => {
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }
    });

    // Simulierter KI-Texteditor
    function generateAiText() {
        showAlert('KI-Vorschlag: „Bitte Rückruf bis Freitag 15 Uhr.“', 'info', 4000);
    }
   </script>
   <script>
   </script>
  </div>
 </body>
</html>
